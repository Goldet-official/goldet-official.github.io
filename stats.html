<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Goldet | Stats</title>
<link rel="stylesheet" href="stats.css">
<link href="https://fonts.googleapis.com/css2?family=Titan+One&display=swap" rel="stylesheet">
</head>
<body>

<div class="sidebar">
  <h2 class="logo">Goldet</h2>
  
  <ul>
    <li>ğŸ† Stats</li>
    <li>ğŸ“Š Leaderboard</li>
    <li>ğŸ’¬ Chat</li>
    <li>ğŸ›¡ï¸ Clans</li>
    <li>ğŸ›’ Market</li>
    <li>ğŸ“¦ Items</li>
    <li>âš™ï¸ Settings</li>
    <li>ğŸ“° News</li>
  </ul>
</div>

<div class="main">

  <!-- Top Profile Card -->
  <div class="profile-card">
    <div class="avatar"></div>
    <div class="profile-info">
      <h2 class="username" id="usernameDisplay">Loading...</h2>

      <div class="level-bar">
        <div class="bar-fill" id="xpBar"></div>
      </div>

      <p class="level-text" id="levelDisplay">Level 0</p>
    </div>

    <div class="profile-actions">
      <button class="btn">View Stats</button>
      <button class="btn">Trade</button>
    </div>
  </div>

  <!-- Stats Row -->
  <div class="stats-row">
    <div class="stat-box">
      <p class="stat-title">Tokens</p>
      <p class="stat-value" id="tokensDisplay">0</p>
    </div>

    <div class="stat-box">
      <p class="stat-title">Blocks Unlocked</p>
      <p class="stat-value" id="blocksDisplay">0 / 0</p>
    </div>

    <div class="stat-box">
      <p class="stat-title">Packs Opened</p>
      <p class="stat-value" id="packsDisplay">0</p>
    </div>

    <div class="stat-box">
      <p class="stat-title">Messages Sent</p>
      <p class="stat-value" id="messagesDisplay">0</p>
    </div>
  </div>

  <!-- Friends -->
  <h2 class="section-title">Friends</h2>
  <div class="friends-grid">
    <div class="friend-card"></div>
    <div class="friend-card"></div>
    <div class="friend-card"></div>
    <div class="friend-card"></div>
    <div class="friend-card"></div>
    <div class="friend-card"></div>
    <div class="friend-card"></div>
    <div class="friend-card"></div>
  </div>

  <!-- Requests -->
  <h2 class="section-title">Requests</h2>
  <div class="requests-grid">
    <div class="request-card"></div>
    <div class="request-card"></div>
    <div class="request-card"></div>
  </div>

</div>


<!-- GOLDEN USER LOADER (NO FIREBASE AUTH, WORKS WITH YOUR SYSTEM) -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
  import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDe9lhPW1DEli3moVwtywCE0ucXKoZSoXs",
    authDomain: "goldet-504aa.firebaseapp.com",
    databaseURL: "https://goldet-504aa-default-rtdb.firebaseio.com",
    projectId: "goldet-504aa",
    storageBucket: "goldet-504aa.firebasestorage.app",
    messagingSenderId: "36312610816",
    appId: "1:36312610816:web:ded0576d78ebf1ceba00e5",
    measurementId: "G-TTJNTC824V"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // Load logged-in username from localStorage
  const currentUser = localStorage.getItem("goldetCurrentUser");

  if (!currentUser) {
    document.getElementById("usernameDisplay").textContent = "Not Logged In";
  } else {
    loadUserStats(currentUser);
  }

  async function loadUserStats(username) {
    const snap = await get(ref(db, "users/" + username));
    const data = snap.val();

    if (!data) {
      document.getElementById("usernameDisplay").textContent = username + " (No Data)";
      return;
    }

    // Username
    document.getElementById("usernameDisplay").textContent = username;

    // Level + XP
    document.getElementById("levelDisplay").textContent =
      "Level " + (data.level ?? 1);

    // XP bar (if stored)
    let xp = data.xp ?? 0;
    document.getElementById("xpBar").style.width = xp + "%";

    // Tokens
    document.getElementById("tokensDisplay").textContent =
      data.tokens ?? 0;

    // Blocks
    let unlocked = data.blocksUnlocked ?? 0;
    let total = data.totalBlocks ?? 0;
    document.getElementById("blocksDisplay").textContent =
      unlocked + " / " + total;

    // Packs opened
    document.getElementById("packsDisplay").textContent =
      data.packsOpened ?? 0;

    // Messages sent
    document.getElementById("messagesDisplay").textContent =
      data.messages ?? 0;
  }
</script>

</body>
</html>
